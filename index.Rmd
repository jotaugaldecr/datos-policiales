---
title: "Datos Policiales"
author: "Jonathan Ugalde"
date: '2022-06-15'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, message=FALSE}



library(ggplot2)
library(plotly)
library(dplyr)
library(DT)
library(readxl)
library(lubridate)

```

```{r lectura de datos}
datos_policiales <-
  readxl::read_excel("C:/Users/PC/Documents/2022 UCR I/PROCESAMIENTO DE DATOS/Datos Policiales/datos-policiales/estadisticaspoliciales2021.xls")

```

# TABLA

```{r tabla}
datos_policiales %>%
  dplyr::select(Delito, Fecha, Victima, Edad, Genero, Provincia, Canton) %>%
  datatable(options = list (pageLength = 100), colnames = c("Delito", "Fecha", "Víctima", "Edad", "Género", "Provincia", "Cantón"))

```




# Grafico

```{r grafico}
grafico <-
datos_policiales %>%
  count(Delito) %>%
  ggplot(aes(x = reorder(Delito, n), y = n)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  ggtitle("Registro de Delitos") + 
  xlab("Delito") +
  ylab("Cantidad") +
  theme_minimal()



ggplotly(grafico) %>% config(locale = 'es')

```

# GRAFICO DELITOS POR MES


```{r grafico-delitos}
datos_policiales %>%
  ggplot(aes(x = Delito, y = Fecha)) +
  geom_bar(stat = "identity") +
  coord_flip() 

```



# GRAFICO CANTONES

```{r grafico-cantones}
datos_policiales %>%
  ggplot(aes(x = Delito, y = Canton)) +
  geom_bar(stat = "identity") +
  coord_flip()
  
```


